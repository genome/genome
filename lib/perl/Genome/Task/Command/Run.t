#!/usr/bin/env genome-perl

use strict;
use warnings;

use Data::Dumper;
use above "Genome";
use Command;
use Test::More;
use Test::Differences;
use File::Path;
use Fcntl ':mode';
use JSON::XS;

plan tests=>3;

$ENV{TEST_MODE} = 1;
$ENV{UR_DBI_NO_COMMIT} = 1;
$ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;

my $task_params = {filter=>'name~jeldred%'};
my $task = Genome::Task->create(command_class=>'Genome::Model::Command::List', status=>'pending', params=>encode_json($task_params), user_id=>'jeldred', time_submitted=>UR::Context->current->now);
ok($task, "task created for good params");

my $tmp_dir = Genome::Sys->base_temp_directory();

my $run_cmd = Genome::Task::Command::Run->create(task=>$task);
ok($run_cmd, "created run cmd successfully");

ok($run_cmd->execute, "executed cmd ok");

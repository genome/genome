#!/usr/bin/env genome-perl

BEGIN {
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
}

use strict;
use warnings;

use above "Genome";
use Test::More;

my $pkg = 'Genome::Qc::Tool::Bedtools::Intersect';
use_ok($pkg);

my $data_dir = __FILE__.".d";

# my $output = File::Spec->join($data_dir, 'out');
my $output = Genome::Sys->create_temp_file_path;
my $temp_file = Genome::Sys->create_temp_file_path;

my $tool = $pkg->create(
    gmt_params => {
        input_file_a => $temp_file,
        input_file_b => $temp_file,
        input_file_a_format => 'bed',
        intersection_type => 'unique',
        header => 1,
        output_file => $output,
    }
);
ok($tool->isa($pkg), 'Tool created successfully');

my @expected_cmd_line = (
    'gmt',
    'bed-tools',
    'intersect',
    sprintf('--input_file_a=%s', $temp_file),
    sprintf('--input_file_b=%s', $temp_file),
    sprintf('--output_file=%s', $output),
    '--intersection_type=unique',
    '--input_file_a_format=bed',
    '--header',
);
is_deeply([$tool->cmd_line], [@expected_cmd_line], 'Command line list as expected');

done_testing;
